<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Rotor Position Calculation | Harmony 3 Motor Control</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Rotor Position Calculation" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 Motor Control package" /> <meta property="og:description" content="Harmony 3 Motor Control package" /> <link rel="canonical" href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/rotor_position_measurement.html" /> <meta property="og:url" content="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/rotor_position_measurement.html" /> <meta property="og:site_name" content="Harmony 3 Motor Control" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Rotor Position Calculation" /> <script type="application/ld+json"> {"@type":"WebPage","url":"../../../../algorithms/pmsm_foc/mc_plant_docs/theory/rotor_position_measurement.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"headline":"Rotor Position Calculation","description":"Harmony 3 Motor Control package","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="../../../../index.html" class="nav-list-link">Microchip MPLABÂ® Harmony 3 Motor Control</a></li><li class="nav-list-item"><a href="../../../../algorithms/pmsm_foc/readme.html" class="nav-list-link">PMSM FOC Component</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/introduction.html" class="nav-list-link">Motor Control Plant Projects</a><ul class="nav-list "><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/theoretical_background.html" class="nav-list-link">Theoretical Background</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/pmsm_motor.html" class="nav-list-link">Permanent Magnet Synchronous Motors</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/field_oriened_control.html" class="nav-list-link">Field Oriented Control</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/current_measurement.html" class="nav-list-link">Current Measurement</a> </li><li class="nav-list-item active"> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/rotor_position_measurement.html" class="nav-list-link active">Rotor Position Calculation</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/software_design.html" class="nav-list-link">Software Design</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/software_architecture.html" class="nav-list-link">Implementation Details</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/getting_started.html" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/create_mc_project_with_mcc.html" class="nav-list-link">Create MCC project for MC Plant</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/motor_control_plant_manager.html" class="nav-list-link">MC Plant Manager</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/hardware_modules.html" class="nav-list-link">Hardware Modules</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/peripheral_modules.html" class="nav-list-link">Peripheral Modules</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/software_modules.html" class="nav-list-link">Software Modules</a> </li><li class="nav-list-item "> <a href="../../../../algorithms/pmsm_foc/mc_plant_docs/mc_plant/generate_mc_code_with_mcc.html" class="nav-list-link">Generate Code with MCC</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../algorithms/pmsm_foc/non_mc_plant.html" class="nav-list-link">Non Motor Control Plant Projects</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../../algorithms/pmsm_foc/sw_design.html" class="nav-list-link">Software Design</a></li><li class="nav-list-item "><a href="../../../../algorithms/pmsm_foc/control_algorithm.html" class="nav-list-link">Control Algorithm</a></li><li class="nav-list-item "><a href="../../../../algorithms/pmsm_foc/configurations.html" class="nav-list-link">Configuring the Library</a></li><li class="nav-list-item "><a href="../../../../algorithms/pmsm_foc/using_the_library.html" class="nav-list-link">Using the Library</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../release_notes.html" class="nav-list-link">Release notes</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../../apps/readme.html" class="nav-list-link">Motor Control Application Repositories</a></li></ul></li><li class="nav-list-item"><a href="../../../../mplab_harmony_license.html" class="nav-list-link">License</a></li><li class="nav-list-item"><a href="../../../../plugins/mc_plant/intro.html" class="nav-list-link">Getting Started with Create React App</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Harmony 3 Motor Control" aria-label="Search Harmony 3 Motor Control" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/introduction.html">Motor Control Plant Projects</a></li> <li class="breadcrumb-nav-list-item"><a href="../../../../algorithms/pmsm_foc/mc_plant_docs/theory/theoretical_background.html">Theoretical Background</a></li> <li class="breadcrumb-nav-list-item"><span>Rotor Position Calculation</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <!-- Styling --> <style> body { counter-reset: h1; padding: 20px; } h1 { background-color: red; color: white; counter-reset: h2 } h2 { background-color: red; color: white; counter-reset: h3 } h3 { background-color: red; color: white; counter-reset: h4 } h1:before { background-color: red; color: white; counter-increment: h1; content: counter(h1) ". " } h2:before { background-color: red; color: white; counter-increment: h2; content: counter(h1) "." counter(h2) ". " } h3:before { background-color: red; color: white; counter-increment: h3; content: counter(h1) "." counter(h2) "." counter(h3) ". " } h4:before { background-color: red; color: white; counter-increment: h4; content: counter(h1) "." counter(h2) "." counter(h3) "." counter(h4) ". " } p{ color: black; font-family: "Arial", Helvetica, sans-serif; } article { max-width: 50em; background: white; padding: 2em; margin: 1em auto; } .table-of-contents { float: right; width: 40%; background: #eee; font-size: 0.8em; padding: 1em 2em; margin: 0 0 0.5em 0.5em; } .table-of-contents ul { padding: 0; } .table-of-contents li { margin: 0 0 0.25em 0; } .table-of-contents a { text-decoration: none; } .table-of-contents a:hover, .table-of-contents a:active { text-decoration: underline; } h3:target { animation: highlight 1s ease; } @keyframes highlight { from { background: yellow; } to { background: white; } } li{ color: black; font-family: "Arial", Helvetica, sans-serif; } table{ color: black; font-family: "Arial", Helvetica, sans-serif; } } } </style> <h1 id="rotor-position-sensing-"> <a href="#rotor-position-sensing-" aria-labelledby="rotor-position-sensing-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rotor Position Sensing <a name="introduction"></a> </h1> <p>The rotor position information is crucial to control the torque of the motor of an electric drive with Field Oriented Control. The following section describes different rotor position measurement technique in an electric drive, and how it can be configured with Motor Control Plant.</p> <h2 id="rotor-position-sensing-technique-"> <a href="#rotor-position-sensing-technique-" aria-labelledby="rotor-position-sensing-technique-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rotor Position Sensing Technique <a name="Rotor_Position_Sensing"></a> </h2> <p>Rotor position measurement technique can be broadly classified into sensored techniques and sensorless techniques. The sensored techniques uses actual physical sensors to determine the rotor position, whereas sensorless techniques uses estimators or state observers with phase currents and voltages as inputs to determine the rotor angle.</p> <p>Figure 1 shows different measurement rotor position sensing technique used in electric drives.</p> <p align="center"> <img src="images/rotor_position_sensing_techniques.jpg" /> <figcaption align="center">Figure.1 - Rotor Position Sensing Techniques </figcaption> </p> <p>In this article, we will focus on the few of the popular rotor position measurement techniques, and how to configure them with <strong>Motor Control Plant</strong>.</p> <h3 id="quadrature-encoder-"> <a href="#quadrature-encoder-" aria-labelledby="quadrature-encoder-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Quadrature Encoder <a name="Rotor_Position_Sensing_qdec"></a> </h3> <p>Quadrature encoders, also known as incremental encoders or optical encoders, detect position and speed of rotating motion systems.</p> <p>A typical quadrature encoder includes a slotted wheel attached to the shaft of the motor and an emitter/detector module that senses the slots in the wheel. Typically, three output channels, Phase A (QEAx), Phase B (QEBx) and Index (INDXx), provide information on the movement of the motor shaft, including distance and direction. The Phase A and Phase B channels have a unique relationship. If Phase A leads Phase B, the direction of the motor is deemed positive, or forward. If Phase A lags Phase B, the direction of the motor is deemed negative or reverse. The Index pulse occurs once per mechanical revolution and is used as a reference to indicate an absolute position. For a relative timing diagram of these three signals, refer to Figure 1.</p> <p>The quadrature signals produced by the encoder can have four unique states (01, 00, 10 and 11) that reflect the relationship between QEAx and QEBx. Figure 1 shows these states for one count cycle. The order of the states reverses when the direction of travel changes. The quadrature decoder increments or decrements the 16-bit Up/Down Counter (POSxCNT) for each change of state. The counter increments when QEAx leads QEBx and decrements when QEBx leads QEAx.</p> <p>For more details refer <a href="https://ww1.microchip.com/downloads/en/Appnotes/Sensored-Encoder-Based)-Field-Oriented-Control-of-Three-Phase-%20Permanent-%20Magnet-%20Synchronous-DS00002757A.pdf">AN2757</a></p> <p align="center"> <img src="images/qudarture_encoder_figure.JPG" /> <figcaption align="center">Figure.1 - Quadrature Encoder </figcaption> </p> <h3 id="back-emf-with-pll-"> <a href="#back-emf-with-pll-" aria-labelledby="back-emf-with-pll-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Back EMF with PLL <a name="Rotor_Position_Sensing_pll"></a> </h3> <p>The Back EMF with PLL is a technique where the BEMF is used to estimate speed and position. It is based on the principle that when the stator and rotor magnetic fluxes are orthogonal to each other, the BEMF across the d-axis is â0â. The PLL is used to drive d-axis BEMF to zero, thereby estimating the rotor position and speed.</p> <p>For more details refer <a href="https://ww1.microchip.com/downloads/en/Appnotes/Sensorless-FOC-For-PMSM-using-PLL-Estimator-FW-AN-DS00002520C.pdf">AN2520</a></p> <h3 id="reduced-order-luenberger-observer-"> <a href="#reduced-order-luenberger-observer-" aria-labelledby="reduced-order-luenberger-observer-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reduced Order Luenberger Observer <a name="Rotor_Position_Sensing_rolo"></a> </h3> <p>The Reduced Order Luenberger Observer (ROLO) belongs to a class of linear observers used to estimate the internal state of an observable system based on the measured input and output. The ROLO is used to estimate the back EMFs of the PMSM. The BEMF vector position is found with an arctan() operation from the BEMF components, which is then used to estimate the rotor position angle. For more details refer <a href="https://ww1.microchip.com/downloads/en/AppNotes/00002590B.pdf">AN2590</a></p> <h3 id="sliding-mode-observer-"> <a href="#sliding-mode-observer-" aria-labelledby="sliding-mode-observer-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sliding Mode Observer <a name="Rotor_Position_Sensing_smo"></a> </h3> <p>The Sliding Mode Observers (SMO) belongs to a class of non-linear observers used to estimate the internal state of an observable system based on the measured input and output. The SMO is used to estimate the back EMFs of the PMSM. The BEMF vector position is found with an arctan() operation from the BEMF components, which is then used to estimate the rotor position angle. For more details refer <a href="https://ww1.microchip.com/downloads/en/AppNotes/00002590B.pdf">AN4398</a></p> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
